name: deploy

on: push

jobs:
    deploy:
        runs-on: ubuntu-latest
        steps:
            - name: Checkout
              uses: actions/checkout@v5

            - name: ssh setup
              run: |
                mkdir -p ~/.ssh
                echo "${{secrets.MY_PRIVATE_KEY}}" > ~/.ssh/meinPrivateKey
                chmod 600 ~/.ssh/meinPrivateKey
                ssh-keyscan -H ${{secrets.EC2_IP}} >> ~/.ssh/known_hosts

            - name: SSH connection
              run: |
               ssh -i ~/.ssh/meinPrivateKey ubuntu@${{ secrets.EC2_IP }} "mkdir -p ~/Aufgabeworkflowdocker"
               scp -i ~/.ssh/meinPrivateKey Aufgabeworkflowdocker/info.txt ubuntu@${{ secrets.EC2_IP }}:~/Aufgabeworkflowdocker/info.txt
               ssh -i ~/.ssh/meinPrivateKey ubuntu@${{ secrets.EC2_IP }} "ls -l ~/Aufgabeworkflowdocker && head -n 1 ~/Aufgabeworkflowdocker/info.txt"


